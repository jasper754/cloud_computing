<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GitHub Token Tool</title>
<style>
body {
    font-family: Arial, sans-serif;
    background:#f5f7fb;
    margin:0;
    padding:20px;
}
.container {
    max-width:800px;
    margin:auto;
    background:white;
    padding:20px;
    border-radius:10px;
    box-shadow:0 5px 15px rgba(0,0,0,0.1);
}
h1 {
    text-align:center;
    color:#4a56e2;
}
.section {
    margin-top:25px;
    padding-top:15px;
    border-top:1px solid #ddd;
}
button {
    background:#4a56e2;
    color:white;
    border:none;
    padding:8px 15px;
    border-radius:5px;
    cursor:pointer;
    margin-top:8px;
}
button:hover {
    background:#3942b8;
}
pre {
    background:#f1f1f1;
    padding:10px;
    border-radius:6px;
    overflow:auto;
}
img {
    max-width:100%;
    margin-top:10px;
    border-radius:8px;
}
</style>
</head>
<body>

<div class="container">
<h1>ðŸš€ GitHub Token Tool</h1>

<!-- Fetch File -->
<div class="section">
<h3>ðŸ“„ Fetch File</h3>
<input type="text" id="filePath" placeholder="Enter file path (e.g., 67.txt)">
<button onclick="fetchFile()">Fetch File</button>
<pre id="file-output">Output here...</pre>
</div>

<!-- Fetch Image -->
<div class="section">
<h3>ðŸ–¼ Fetch Image</h3>
<input type="text" id="imagePath" placeholder="Enter image path (e.g., patrick.png)">
<button onclick="fetchImage()">Fetch Image</button>
<div id="image-output"></div>
</div>

<!-- Upload File -->
<div class="section">
<h3>â¬† Upload File</h3>
<input type="file" id="fileInput">
<br>
<button onclick="uploadFile()">Upload</button>
</div>

</div>

<script>
// ===== CONFIG =====
const TOKEN = "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"; // <-- Replace with your token
const OWNER = "jasper754";
const REPO = "cloud_computing";
const BRANCH = "main";

// ===== FETCH FILE =====
async function fetchFile() {
    const path = document.getElementById("filePath").value;
    const output = document.getElementById("file-output");
    if (!path) return alert("Enter a file path.");

    const url = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${path}?ref=${BRANCH}`;
    try {
        const res = await fetch(url, {
            headers: { 
                Authorization: `token ${TOKEN}`,
                Accept: "application/vnd.github.v3+json"
            }
        });
        if (!res.ok) throw new Error(`${res.status} ${res.statusText}`);
        const data = await res.json();
        output.textContent = atob(data.content);
    } catch (err) {
        output.textContent = "Failed to load: " + err;
    }
}

// ===== FETCH IMAGE =====
async function fetchImage() {
    const path = document.getElementById("imagePath").value;
    const container = document.getElementById("image-output");
    container.innerHTML = "";
    if (!path) return alert("Enter an image path.");

    const url = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${path}`;
    try {
        const res = await fetch(url, {
            headers: { Authorization: `token ${TOKEN}` }
        });
        if (!res.ok) throw new Error(`${res.status} ${res.statusText}`);
        const data = await res.json();
        if (!data.content) throw new Error("No content returned");
        const img = new Image();
        img.src = `data:image/png;base64,${data.content}`;
        container.appendChild(img);
    } catch (err) {
        container.textContent = "Failed to load image: " + err;
    }
}

// ===== UPLOAD FILE =====
async function uploadFile() {
    const fileInput = document.getElementById("fileInput");
    if (!fileInput.files.length) return alert("Select a file first.");

    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.onload = async function(e) {
        const content = e.target.result.split(',')[1];
        const path = file.name;
        const url = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${path}`;

        const data = {
            message: `Add ${file.name}`,
            content: content,
            branch: BRANCH
        };

        try {
            const res = await fetch(url, {
                method: "PUT",
                headers: {
                    Authorization: `token ${TOKEN}`,
                    "Content-Type": "application/json",
                    Accept: "application/vnd.github.v3+json"
                },
                body: JSON.stringify(data)
            });

            const result = await res.json();
            if (res.ok) alert("âœ… Upload success!");
            else alert("âŒ Upload failed: " + result.message);
        } catch (err) {
            alert("Upload failed: " + err);
        }
    };

    reader.readAsDataURL(file);
}
</script>

</body>
</html>
